<!DOCTYPE html>
<html>
  <head>
    <title>Assignment 1</title>
    <script  src="https://threejs.org/build/three.js"></script>
    <script  src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    <script src='https://threejs.org/examples/js/libs/dat.gui.min.js'></script>
    <script  src= "https://threejs.org/examples/js/loaders/OBJLoader.js"> </script>
    <script src= "https://threejs.org/examples/js/loaders/MTLLoader.js"> </script>
	

    <script>
	//source site: https://free3d.com/3d-model/cobblestones-3-86328.html
       // Add your own Javascript code/methods here.
      function mainFunction(){
       var renderer = new THREE.WebGLRenderer();//let renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );
        renderer.setPixelRatio( window.devicePixelRatio );
		renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap; 
        renderer.setClearColor (0x888888, 1);
        document.body.appendChild( renderer.domElement );

        let scene = new THREE.Scene();

        let aspect = window.innerWidth / window.innerHeight;
        let camera = new THREE.PerspectiveCamera( 30, aspect, 1, 1000 );
        camera.position.z = 10;
		camera.position.y = 10;
		camera.position.x = 30;
        scene.add(camera);
		let backLight = new THREE.DirectionalLight(0xffffff, 0.5);
        //backLight.position.set(1, -0.5, -1).normalize(); 
		
		backLight.position.set(1, -.5, -1).normalize(); 

		let fillLight = new THREE.DirectionalLight(0x8080FF, 0.5);
        fillLight.position.set(1, 0, 1);
		
        let keyLight = new THREE.DirectionalLight(0xFFBF80, 1.0);
        keyLight.position.set(-1, 0.5, 1)
		
		
		/*scene.add(keyLight);
		scene.add(fillLight);
		scene.add(backLight);*/
		
		//Create a DirectionalLight and turn on shadows for the light
		var light = new THREE.DirectionalLight( 0xffffff, 1, 100 );
		light.position.set( 0, 1, 0 ); 			//default; light shining from top
		light.castShadow = true;            // default false
		scene.add( light );
		
        
				//Set up shadow properties for the light
		light.shadow.mapSize.width = 512;  // default
		light.shadow.mapSize.height = 512; // default
		light.shadow.camera.near = 0.5;    // default
		light.shadow.camera.far = 500;     // default
        
		//Create a sphere that cast shadows (but does not receive them)
		
			let mtlLoader = new THREE.MTLLoader();
			mtlLoader.load('./low-poly-tree.mtl',
			function(mtl)
			{
				let objLoader = new THREE.OBJLoader();
				objLoader.setMaterials(mtl);
				//load a resource
				objLoader.load('./low-poly-tree.obj', function(object)
				{
				object.traverse( function( mtl ) 
				{ if ( mtl instanceof THREE.Mesh ) 
				{ mtl.castShadow = true; } } );;
					object.position.z=5;
					object.position.y=0;
					//object.position.x=5;
					object.castShadow=true;
					object.receiveShadow=false;
					tree=object;
					scene.add(object);
					
					//render();
				})
			}
		);
		/*var sphereGeometry = new THREE.SphereBufferGeometry( 5, 32, 32 );
		var sphereMaterial = new THREE.MeshStandardMaterial( { color: 0xff0000 } );
		var sphere = new THREE.Mesh( sphereGeometry, sphereMaterial );
		sphere.scale.set(.05,.05,.05);
		sphere.castShadow = true; //default is false
		sphere.receiveShadow = false; //default
		scene.add( sphere );
		*/
				//Create a plane that receives shadows (but does not cast them)
		var planeGeometry = new THREE.PlaneBufferGeometry( 20, 20, 32, 32 );
		var planeMaterial = new THREE.MeshStandardMaterial( { color: 0x00ff00 } )
		var plane = new THREE.Mesh( planeGeometry, planeMaterial );
		plane.rotateX(-Math.PI/2);
		plane.position.y=-5;
		plane.receiveShadow = true;
		scene.add( plane );
		
		//Create a helper for the shadow camera (optional)
		var helper = new THREE.CameraHelper( light.shadow.camera );
		scene.add( helper );

        let render = function () {
          renderer.render( scene, camera );
        };

        let cameraControls = new THREE.OrbitControls( camera, renderer.domElement  );
        cameraControls.addEventListener("change",render,false)

        // add your MTL and OBJ file loading related code.
		// instantiate a loader

			

        render();
        
        let resize = function () {
          renderer.setSize(window.innerWidth, window.innerHeight);
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          render();
        };
		

        window.addEventListener("resize",resize, false)
       
        THREE.DefaultLoadingManager.onLoad = function () 
        {
            render();
        }; 
      }
	  
    </script>
  </head>
  <body onload="mainFunction();">
  <h2>--Ashley Smith as979400 
  https://free3d.com/3d-model/low-poly-tree-498046.html--</h2>
  </body>
</html>
